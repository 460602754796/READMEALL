# 系统说明

中文简体

> 该代码用于学习和测试使用，请勿使用于其他用途。

**该系统使用 `Nginx 1.8` `Mysql 5.5` `Php5.6`进行搭建.**

## 搭建方法

```bash
# 安装系统需要的运行环境和基本三方组件
sh ./script/install.sh

# 导入基础数据库
mysql -u{{root}} -p{{password}} pay < ./ori_clear.sql

# 如果必须，请重启Mysql, Nginx, Redis, Php, Firewalld服务
systemctl restart mysqld
systemctl restart redis
systemctl restart nginx
systemctl restart php-fpm
systemctl restart firewalld

# 必要时，使用nptd进行时间自动矫正
systemctl restart ntpd

# 必要时，修改数据库密码
vim Application/Common/Conf/db.php

# 添加crontab任务
crontab -e
```

## 使用说明

添加支付通道
```bash
通道管理 << 支付产品设置 << 添加支付产品
通道管理 << 入金渠道设置 << 添加供应商
通道管理 << 入金渠道设置 << 子账户 << 添加账户
```

添加代付通道
```bash
通道管理 << 代付渠道设置 << 添加供应商

# 设置提款规则
提款管理 << 代付结算
```

创建商户

**用户默认支付密码为`123456`**
```bash
# 其中Email可以随意填写, 注册完毕页面会重定向到主页
用户管理 -> 邀请码 -> 添加邀请码 -> 注册地址

# 解冻用户
用户管理 -> 冻结用户

# 认证用户
用户管理 -> 未认证用户

# 编辑用户, 如用户信息
用户管理 -> 已认证用户 -> 编辑

# 设置用户使用通道
用户管理 -> 已认证用户 -> 通道

# 必要时指定通道
用户管理 -> 已认证用户 -> 指定

# 设置费率, 用户界面查看到的通道费率是此处的T1
用户管理 -> 已认证用户 -> 费率

# 设置提现规则, 必要时使用个人规则
用户管理 -> 已认证用户 -> 提现
```

支付订单查看
```bash
订单管理
```

代付订单查看
```bash
提款管理 -> 代付结算
```

代付通道余额查看
```bash
通道管理 -> 代付渠道设置 -> 查询余额
```

支付强制回调
```bash
订单管理 -> 全部订单 -> 设置为已支付
```

支付通知异常补回调

**只有回调异常的订单可以补发回调**
```bash
订单管理 -> 通知异常订单 -> 订单详情 -> 补发通知
```

支付订单冻结

**订单冻结后, 该订单金额将变为不可结算金额**
```bash
订单管理 -> 全部订单 -> 冻结订单
```

支付订单解冻

**订单解冻后, 该订单金额将变为可结算金额**
```bash
订单管理 -> 冻结订单 -> 解冻订单
```

代付订单

```bash
提款管理 -> 代付结算
```

结算管理
```bash
提款管理 -> 手动结算
```

## 用户后台

用户结算

```bash
# 添加银行卡
账户管理 -> 添加支付方式

# 结算申请
结算管理 -> 结算申请
```